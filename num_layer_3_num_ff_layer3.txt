Namespace(seed=123, train_json='/rds/user/yo279/hpc-work/MLMI2/fbanks/train_fbank.json', val_json='/rds/user/yo279/hpc-work/MLMI2/fbanks/dev_fbank.json', test_json='/rds/user/yo279/hpc-work/MLMI2/fbanks/test_fbank.json', batch_size=4, num_layers=3, fbank_dims=23, model_dims=128, concat=1, lr=0.5, vocab='vocab_39.txt', report_interval=50, num_epochs=20, dropout_rate=0.5, clip_max_norm=1, num_ff_layers=3)
Total number of model parameters is 960760
EPOCH 1:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 2:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 3:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 4:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 5:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 6:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 7:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 8:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 9:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 10:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 11:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 12:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 13:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 14:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 15:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 16:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 17:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 18:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 19:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
EPOCH 20:
  batch 50 loss: nan
  batch 100 loss: nan
  batch 150 loss: nan
  batch 200 loss: nan
  batch 250 loss: nan
  batch 300 loss: nan
  batch 350 loss: nan
  batch 400 loss: nan
  batch 450 loss: nan
  batch 500 loss: nan
  batch 550 loss: nan
  batch 600 loss: nan
  batch 650 loss: nan
  batch 700 loss: nan
  batch 750 loss: nan
  batch 800 loss: nan
  batch 850 loss: nan
  batch 900 loss: nan
LOSS train nan valid nan, valid PER 100.00%
train_loss
[nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan]
valid_loss
[nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan]
valid_per
[100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
Traceback (most recent call last):
  File "/rds/user/yo279/hpc-work/MLMI2/exp/run.py", line 65, in <module>
    model_path = train(model, args)
                 ^^^^^^^^^^^^^^^^^^
  File "/rds/user/yo279/hpc-work/MLMI2/exp/trainer.py", line 142, in train
    return model_path
           ^^^^^^^^^^
UnboundLocalError: cannot access local variable 'model_path' where it is not associated with a value
